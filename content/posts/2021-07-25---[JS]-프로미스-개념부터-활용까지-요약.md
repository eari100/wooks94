---
title: "[JS] í”„ë¡œë¯¸ìŠ¤ ê°œë…ë¶€í„° í™œìš©ê¹Œì§€ ìš”ì•½"
date: "2021-07-25"
template: "post"
draft: false
slug: "[JS]-í”„ë¡œë¯¸ìŠ¤-ê°œë…ë¶€í„°-í™œìš©ê¹Œì§€-ìš”ì•½"
category: "JavaScript"  
tags:
  - "#JavaScript"
description: ""
---

ì´ ê²Œì‹œë¬¼ì€ [ìë°”ìŠ¤í¬ë¦½íŠ¸ 12. í”„ë¡œë¯¸ìŠ¤ ê°œë…ë¶€í„° í™œìš©ê¹Œì§€ JavaScript Promise | í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì ì…ë¬¸í¸ (JavaScript ES6)](https://www.youtube.com/watch?v=JB_yU6Oe2eE)ë¥¼ ìš”ì•½í–ˆìŠµë‹ˆë‹¤.

# promise

ë¹„ë™ê¸° ìˆ˜í–‰ì„ ìœ„í•´ ì½œë°± ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¤ë¸Œì íŠ¸

## state

1. pending: ì—°ì‚°ì´ ìˆ˜í–‰ ì¤‘
2. fulfilled: `pending`ì—ì„œ ì„±ê³µì ìœ¼ë¡œ ëëƒˆì„ ë•Œ
3. rejected: `pending`ì—ì„œ íŒŒì¼ì„ ì°¾ì§€ ëª»í•˜ê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ì— ë¬¸ì œê°€ ìƒê²¼ì„ ì‹œ

## Producer, Consumer

+ Producer: ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•´ì„œ í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ëƒ„
+ Consumer: ë°ì´í„°ë¥¼ ì†Œë¹„í•¨

## resolve, reject

![Promise-01.png](/media/posts/2021-07-25---[JS]-í”„ë¡œë¯¸ìŠ¤-ê°œë…ë¶€í„°-í™œìš©ê¹Œì§€-ìš”ì•½/Promise-01.png)

`promise`ì˜ ìƒì„±ìë¥¼ ë³´ë©´ `executor`ë¼ëŠ” ì½œë°± í•¨ìˆ˜ë¥¼ ì „ë‹¬í•´ ì¤˜ì•¼ë˜ëŠ” ë° ë‹¤ì‹œ `executor`ë¥¼ ì‚´í´ë³´ë©´ `resolve`, `reject`ë¥¼ ì½œë°± í•¨ìˆ˜ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.

+ resolve: ê¸°ëŠ¥ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰í•´ì„œ ë§ˆì§€ë§‰ì— ìµœì¢… ë°ì´í„°ë¥¼ ì „ë‹¬í•¨
+ reject: ê¸°ëŠ¥ ìˆ˜í–‰ ì¤‘ ì¤‘ê°„ì— ë¬¸ì œê°€ ìƒê¸¸ ì‹œ í˜¸ì¶œ

`Promise`ë¥¼ ìƒì„±í•˜ëŠ” ìˆœê°„ `executor`ê°€ ì‹¤í–‰ëœë‹¤.

```JS
// when new Promise is created,
// the executor runs automatically.
const promise = new Promise((resolve, reject)=> {
    // doing some heavy work (network, read files)
    console.log('doing something...')
})
```

### resolve ì‹¤ìŠµ

`producer` ìƒì„±

```JS
const promise = new Promise((resolve, reject)=> {
    // doing some heavy work (network, read files)
    console.log('doing something...')
    setTimeout(() => {
        resolve('ellie')
    }, 2000)
})
```

`consumers` ìƒì„±

```JS
promise.then((value) => {
    console.log(value) // ellie
})
```

`then`ì€ `resolve` ì½œë°±í•¨ìˆ˜ê°€ ì „ë‹¬í•œ ê°’ì´ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœë‹¤.

### reject ì‹¤ìŠµ

`producer` ìƒì„±, ë„¤íŠ¸ì›Œí¬ê°€ ë¬¸ì œ ìƒê²¼ë‹¤ê³  ê°€ì •í•œë‹¤.

```JS
const promise = new Promise((resolve, reject)=> {
    // doing some heavy work (network, read files)
    console.log('doing something...')
    setTimeout(() => {
        reject(new Error('no network'))
    }, 2000)
})
```
```Bash
VM5131:5 Uncaught (in promise) Error: no network
    at <anonymous>:5:16
```

`producer` ìƒì„±, `catch` í‚¤ì›Œë“œë¥¼ í†µí•´ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•œë‹¤.

```JS
promise
.then(value => {
    console.log(value)
})
.catch(error => {
    console.log(error)
})
.finally(() => {
  console.log('finally')
})
```
```Bash
Error: no network
    at <anonymous>:5:16
```
consoleì— ë‹¤ìŒê°™ì´ ì¶œë ¥ ëœë‹¤.  
`then`ì€ Promissë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ë°”ë¡œ ë’¤ì— `catch`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.  
ì´ê²ƒì„ `ì²´ì´ë‹`ì´ë¼ê³  í•œë‹¤.

## chaining

```JS
const fetchNumber = new Promise((resolve, reject) => {
    setTimeout(() => resolve(1), 1000)
})

fetchNumber
.then(num => num*2)
.then(num => num*3)
.then(num => {
    return new Promise((resolve, reject) => {
        setTimeout(() => resolve(num-1), 1000) 
    })
})
.then(num => console.log(num)) // 2ì´ˆ ë’¤ 5 ì¶œë ¥
```

### Error Handling

```JS
const getHen = () =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve('ğŸ“'), 1000)
  })
const getEgg = hen =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${hen} => ğŸ¥š`), 1000)
})
const cook = egg =>
  new Promise((resolve, reject) => {
    setTimeout(() => resolve(`${egg} => ğŸ³`), 1000)
})

getHen()
.then(hen1 => getEgg(hen1))
.then(egg => cook(egg))
.then(meal => console.log(meal))

// ğŸ“ => ğŸ¥š => ğŸ³
```

ì—¬ê¸°ì„œ ì½œë°±í•¨ìˆ˜ë¥¼ ì‚¬ìš© ì‹œ ë°›ì•„ì˜¤ëŠ” ê°’ì„ ë°”ë¡œ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ ì „ë‹¬ ì‹œ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

```JS
getHen()
  .then(getEgg)
  .then(cook)
  .then(console.log)
```

ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

```JS
const getEgg = hen =>
  new Promise((resolve, reject) => {
    setTimeout(() => reject(new Error(`error! ${hen} => ğŸ¥š`)), 1000)
})
```
```Bash
Uncaught (in promise) Error: error! ğŸ“ => ğŸ¥š
    at <anonymous>:7:29
```
ì œì¼ ì•„ë˜ì— `catch` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ í•¸ë“¤ë§ í•´ë³´ì

```JS
getHen()
  .then(getEgg)
  .then(cook)
  .then(console.log)
  .catch(console.log)
```
```Bash
Error: error! ğŸ“ => ğŸ¥š
    at <anonymous>:7:29
```
ê³„ë€ì„ ì–»ì–´ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆë‹¤ë©´ ë¹µì„ ì–»ì–´ì„œ ì½”ë“œë¥¼ ì²˜ë¦¬í•˜ë„ë¡ ìˆ˜ì •í•´ë³´ì

```JS
getHen()
  .then(getEgg)
  .catch(error => {
    return 'ğŸŒ­'
  })
  .then(cook)
  .then(console.log)
  .catch(console.log)

  // ğŸŒ­ => ğŸ³
```

##### reference

[ìë°”ìŠ¤í¬ë¦½íŠ¸ 12. í”„ë¡œë¯¸ìŠ¤ ê°œë…ë¶€í„° í™œìš©ê¹Œì§€ JavaScript Promise | í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì ì…ë¬¸í¸ (JavaScript ES6)](https://www.youtube.com/watch?v=JB_yU6Oe2eE)